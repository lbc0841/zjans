---
title: "a223. 10298 - Power Strings"
description: ""
date: 2025-08-30
tags: ["KMP"]
---

### # é¡Œç›®ç°¡è¿°

***

## è§£æ³•ä¸€ã€KMP

### ğŸ”¹ æœ€é•·å…¬å…±å‰å¾Œç¶´

é–‹ä¸€å€‹å¤§å°ç‚º `s.size()` çš„çŸ©é™£ `kmp[]`<br>
å…¶ä¸­ `kmp[i]` ç´€éŒ„çš„æ˜¯ `s[0] ~ s[i]` çš„ **æœ€é•·èµ·å§‹ä½ç½®ä¸åŒçš„å‰å¾Œç¶´å­—ä¸²** é•·åº¦

åˆå§‹åŒ– `kmp[0] = 0` (`s[0]` è·Ÿ `s[0]` èµ·å§‹ä½ç½®ç›¸åŒ)<br>
å¦‚æœ `s[i] = s[kmp[i-1]]` å‰‡ `kmp[i] = kmp[i-1] + 1`<br>
å¦å‰‡ `kmp[i] = 0`

æœ€çŸ­é‡è¤‡å­å­—ä¸²é•·åº¦ `l` = `s.size()` - `kmp.back()`<br>
æœ€å¤§é‡è¤‡æ¬¡æ•¸ = `s.size()` / `l`

é©—è­‰ `s.size()` / `l` æ˜¯å¦èƒ½æ•´é™¤<br>
å¦å‰‡æœ€å¤§é‡è¤‡æ¬¡æ•¸ = 1

<details class="eg" close>
<summary>s = "AAABAAAB"</summary>

ä»¥ `s = "AAABAAAB"` èˆ‰ä¾‹

<font color="#00bb00">ç¶ å­—</font> è¡¨ç¤º **æœ€é•·èµ·å§‹ä½ç½®ä¸åŒçš„å‰å¾Œç¶´å­—ä¸²**<br>
<font color="#ff0000">ç´…å­—</font> ä»£è¡¨åŒ¹é…éŒ¯èª¤ (`kmp[i] = 0`)<br>
åº•ä¸‹çš„æ•¸å­—æ˜¯å­—ä¸²é•·åº¦ (`kmp[i]`)

| A<br>A | A<br>A | A<br>A | B<br>B | A<br>A | A<br>A | A<br>A | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 |   |   |   |   |   |   |   |

| <font color="#00bb00">A</font><br>A | A<br><font color="#00bb00">A</font> | A<br>A | B<br>B | A<br>A | A<br>A | A<br>A | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 | 1 |   |   |   |   |   |   |

| <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br><font color="#00bb00">A</font> | A<br><font color="#00bb00">A</font> | B<br>B | A<br>A | A<br>A | A<br>A | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 | 1 | 2 |   |   |   |   |   |

| <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br><font color="#00bb00">A</font> | <font color="#ff0000">A</font><br><font color="#00bb00">A</font> | B<br><font color="#ff0000">B</font> | A<br>A | A<br>A | A<br>A | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 | 1 | 2 | 0 |   |   |   |   |

| <font color="#00bb00">A</font><br>A | A<br>A | A<br>A | B<br>B | A<br><font color="#00bb00">A</font> | A<br>A | A<br>A | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 | 1 | 2 | 0 | 1 |   |   |   |

| <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br>A | A<br>A | B<br>B | A<br><font color="#00bb00">A</font> | A<br><font color="#00bb00">A</font> | A<br>A | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 | 1 | 2 | 0 | 1 | 2 |   |   |

| <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br>A | B<br>B | A<br><font color="#00bb00">A</font> | A<br><font color="#00bb00">A</font> | A<br><font color="#00bb00">A</font> | B<br>B |
|---|---|---|---|---|---|---|---|
| 0 | 1 | 2 | 0 | 1 | 2 | 3 |   |

| <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br>A | <font color="#00bb00">A</font><br>A | <font color="#00bb00">B</font><br>B | A<br><font color="#00bb00">A</font> | A<br><font color="#00bb00">A</font> | A<br><font color="#00bb00">A</font> | B<br><font color="#00bb00">B</font> |
|---|---|---|---|---|---|---|---|
| 0 | 1 | 2 | 0 | 1 | 2 | 3 | 4 |

å› æ­¤ `AAABAAAB` æœ€çŸ­é‡è¤‡å­å­—ä¸²é•·åº¦ `l` ç‚º<br>
`s.size()` - `kmp.back()` = 4

é‡è¤‡æ¬¡æ•¸ç‚º<br>
`s.size()` / `l` = 2

</details>

### âœ… å®Œæ•´ä»£ç¢¼

è©•åˆ†çµæœ(åƒè€ƒ) ï¼š **<font color="#00bb00">AC</font> (0.1s, 9.8MB)**

```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    string s;
    while (cin >> s && s != ".") {
        int size = s.size();

        vector<int> kmp(size);
        for(int i=1; i<size; i++){
            int j = kmp[i-1];
            while(j>0 && s[i]!=s[j]){
                j = kmp[j - 1];
            }
            if(s[i] == s[j]){
                j++;
            }
            kmp[i] = j;
        }
    
        int p = size - kmp.back(); // period

        if(size%p == 0){
            cout << size/p << "\n";
        }
        else{
            cout << 1 << "\n";
        }
    }

    return 0;
}
```

***

## è§£æ³•äºŒã€çª®èˆ‰

### ğŸ”¹ çª®èˆ‰å› æ•¸

çª®èˆ‰é‡è¤‡å­—ä¸²å¯èƒ½çš„é•·åº¦<br>
åªæœ‰é•·åº¦æ˜¯ `s.size()` å› æ•¸çš„ **é‡è¤‡å­—ä¸²é•·åº¦** æ‰èƒ½è®“ **å­—ä¸²é‡è¤‡æ¬¡æ•¸** æ˜¯æ•´æ•¸<br>
æ¥è‘—å°æ¯å€‹ä½ç½®åˆ¤æ–·æ˜¯å¦ç›¸åŒ (`bool check(int size)`)

<details class="eg" close>
<summary>s = "AAABAAAB"</summary>

ä»¥ `s = "AAABAAAB"` èˆ‰ä¾‹

`s.size() = 8`<br>
å¯èƒ½çš„ **é‡è¤‡å­—ä¸²çš„é•·åº¦** `l` ç‚º 1, 2, 4<br>
å¦‚æœå‡è¨­æ­£ç¢º `s[i]` ç¶“é `l` å€‹å­—ç¬¦å¾Œæœƒå†é‡è¤‡ä¸€æ¬¡ (é‚„æœƒæ˜¯`s[i]`)<br>
å› æ­¤æª¢æŸ¥æ¯å€‹ä½ç½®æ˜¯å¦éƒ½ç¬¦åˆ `s[i] == s[i+l]`

å‡è¨­ `l = 1`<br>
`s[0] == s[0+1]` ç¬¦åˆ<br>
`s[1] == s[1+1]` ç¬¦åˆ<br>
`s[2] == s[2+1]` ä¸ç¬¦åˆ (return false)

å‡è¨­ `l = 2`<br>
`s[0] == s[0+2]` ç¬¦åˆ<br>
`s[1] == s[1+2]` ä¸ç¬¦åˆ (return false)

å‡è¨­ `l = 4`<br>
`s[0] == s[0+4]` ç¬¦åˆ<br>
`s[1] == s[1+4]` ç¬¦åˆ<br>
`s[2] == s[2+4]` ç¬¦åˆ<br>
`s[3] == s[3+4]` ç¬¦åˆ

æ‰€ä»¥å– `l = 4`

</details>

### âœ… å®Œæ•´ä»£ç¢¼

è©•åˆ†çµæœ(åƒè€ƒ) ï¼š **<font color="#00bb00">AC</font> (44ms, 2.2MB)**

```cpp
#include <bits/stdc++.h>
using namespace std;

string s;

bool check(int l){
    for(int i=0; i<s.size()-l; i++){
        if(s[i] != s[i+l]) return false;
    }
    return true;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    while (cin >> s && s != ".") {
        int ans = 1;
        int size = s.size();

        for(int i=1; i<=size/2; i++){
            if(size%i != 0) continue;
            
            if(check(i)){
                ans = size/i;
                break;
            }
        }
    
        cout << ans << "\n";
    }

    return 0;
}
```
